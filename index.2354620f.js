var e={};const t=new class{constructor(e){this.initialState=e,this.currentState=e.map(e=>[...e]),this.tbody=document.querySelector("tbody"),this.score=0}nextMovePossible(){return this.currentState.some((e,t)=>e.some((r,s)=>{let i,a;let o=e[s+1],c=e[s-1];t<3&&(a=this.currentState[t+1][s]),t>0&&(i=this.currentState[t-1][s]);let n=[a,i,c,o].some(e=>0===e),l=[a,i,c,o].some(e=>e===r);return n||l}))}renderHTML(){this.currentState.forEach((e,t)=>{[...this.tbody.children[t].children].forEach((t,r)=>{0===e[r]?this.clearCell(t):(t.textContent=e[r],t.className="field-cell",t.classList.add(`field-cell--${e[r]}`))})})}createNewCell(){let e,t;if(!this.currentState.every(e=>e.every(e=>0!==e))){do e=Math.floor(4*Math.random()),t=Math.floor(4*Math.random());while(0!==this.currentState[e][t])this.currentState[e][t]=2}}clearCell(e){e.className="field-cell",e.textContent=""}move(e){let t="up"===e||"down"===e,r="left"===e||"up"===e?-1:1,s=1===r?3:0,i=e=>1===r?e>=0:e<4,a=!1;for(let e=s;i(e);e-=r)for(let o=s;i(o);o-=r){let s,i=0,c=e,n=o,l=t?e+(i+1)*r:e,h=t?o:o+(i+1)*r,d=this.currentState[c][n];if(0!==d)for(l>=0&&l<4&&(s=this.currentState[l][h]);0===s||s===d;)if(a=!0,0===s){if(this.currentState[l][h]=d,this.currentState[c][n]=0,i++,c=t?e+i*r:e,n=t?o:o+i*r,l=t?e+(i+1)*r:e,h=t?o:o+(i+1)*r,l>=0&&l<4&&h>=0&&h<4)d=this.currentState[c][n],s=this.currentState[l][h];else break}else{this.currentState[l][h]=2*d,this.currentState[c][n]=0,this.score+=2*d,this.getScore();break}}a&&(this.createNewCell(),this.renderHTML(),this.getStatus())}moveLeft(){this.move("left")}moveRight(){this.move("right")}moveUp(){this.move("up")}moveDown(){this.move("down")}getScore(){return document.querySelector(".game-score").textContent=this.score,this.score}getState(){return this.currentState}getStatus(){return this.currentState.every(e=>e.every(e=>0===e))?"idle":this.currentState.some(e=>e.some(e=>2048===e))?(document.querySelector(".message-win").classList.remove("hidden"),"win"):this.nextMovePossible()?"playing":(document.querySelector(".message-lose").classList.remove("hidden"),"lose")}start(){this.createNewCell(),this.createNewCell(),this.renderHTML(),document.querySelector(".message-start").classList.add("hidden")}restart(){document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".message-lose").classList.add("hidden"),this.currentState=this.initialState.map(e=>[...e]),this.score=0,this.getScore(),this.createNewCell(),this.createNewCell(),this.renderHTML()}}([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),r=document.querySelector("button");r.addEventListener("click",function(){r.classList.contains("start")?(t.start(),r.classList.remove("start"),r.classList.add("restart"),r.textContent="Restart"):t.restart()}),document.addEventListener("keydown",function(e){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowDown":t.moveDown();break;case"ArrowUp":t.moveUp()}});
//# sourceMappingURL=index.2354620f.js.map
